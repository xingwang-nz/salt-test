{% set logging_server_ip = salt['pillar.get']('logging_server:ip') %}
{% set redis_port = salt['pillar.get']('logging_server:redis_port') %}
{% set rsyslog_port = salt['pillar.get']('logging_server:rsyslog_port') %}
{% set elasticsearch_cluster_name = salt['pillar.get']('elasticsearch:cluster_name') %}
#input {
#     tcp {
#        port => 4560
#        codec => json
#    }
#}

input {
  redis {
       host => "{{ logging_server_ip }}"
       port => {{ redis_port }}
       type => "tms"
       data_type => "list"
       key => "logstash"
       format => "json_event"
  }
  syslog {
		type => syslog
		port => {{ rsyslog_port }}
  }
}

output {
   #elasticsearch { host => 127.0.0.1 }
   elasticsearch { cluster => "{{ elasticsearch_cluster_name }}" }
   stdout { codec => rubydebug }
}